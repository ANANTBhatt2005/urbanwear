# URBANWEAR Architecture & Flow Diagrams

## ğŸ—ï¸ System Architecture

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                         URBANWEAR SYSTEM                        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   PHP FRONTEND      â”‚â—„â”€â”€â”€â”€APIâ”€â”€â”€â”€â”€â–ºâ”‚  NODE.JS BACKEND     â”‚
â”‚   (XAMPP)           â”‚   (cURL)      â”‚  (Express)           â”‚
â”‚   Port: 80          â”‚              â”‚  Port: 5000          â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤              â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ login.php           â”‚              â”‚ /api/v1/auth         â”‚
â”‚ signup.php          â”‚              â”‚ /api/v1/products     â”‚
â”‚ user-dashboard.php  â”‚              â”‚ /api/v1/orders       â”‚
â”‚ admin-dashboard.php â”‚              â”‚ /api/v1/admin        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜              â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚                                   â”‚
         â”‚              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚              â”‚
         â”‚    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
         â”‚    â”‚  MONGODB ATLAS     â”‚
         â”‚    â”‚  (Cloud Database)  â”‚
         â”‚    â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
         â”‚    â”‚ Collections:       â”‚
         â”‚    â”‚ - users            â”‚
         â”‚    â”‚ - products         â”‚
         â”‚    â”‚ - orders           â”‚
         â”‚    â”‚ - categories       â”‚
         â”‚    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ”„ Authentication Flow

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    AUTHENTICATION FLOW                       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

1. USER SIGNUP
â•â•â•â•â•â•â•â•â•â•â•â•â•
   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
   â”‚ signup.php   â”‚
   â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
          â”‚ Form Submit
          â–¼
   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
   â”‚ POST /api/v1/auth/register â”‚
   â”‚ {name, email, password}   â”‚
   â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
          â”‚ HTTP Request
          â–¼
   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
   â”‚ auth.controller.js           â”‚
   â”‚ - Hash password (bcrypt)     â”‚
   â”‚ - Create user in MongoDB     â”‚
   â”‚ - Generate JWT token         â”‚
   â”‚ - Return token + user        â”‚
   â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
          â”‚ Response
          â–¼
   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
   â”‚ storeAuthToken()         â”‚
   â”‚ - Save token in session  â”‚
   â”‚ - Save user info         â”‚
   â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
          â”‚ $_SESSION['auth_token']
          â”‚ $_SESSION['user_data']
          â–¼
   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
   â”‚ Auto-redirect to         â”‚
   â”‚ user-dashboard.php       â”‚
   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜


2. USER LOGIN
â•â•â•â•â•â•â•â•â•â•â•â•â•
   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
   â”‚ login.php    â”‚
   â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
          â”‚ Form Submit
          â–¼
   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
   â”‚ POST /api/v1/auth/login  â”‚
   â”‚ {email, password}        â”‚
   â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
          â”‚ HTTP Request
          â–¼
   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
   â”‚ auth.controller.js           â”‚
   â”‚ - Find user by email         â”‚
   â”‚ - Compare password (bcrypt)  â”‚
   â”‚ - Generate JWT token         â”‚
   â”‚ - Return token + user        â”‚
   â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
          â”‚ Response
          â–¼
   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
   â”‚ storeAuthToken()         â”‚
   â”‚ - Save token in session  â”‚
   â”‚ - Save user info         â”‚
   â”‚ - Check role             â”‚
   â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
          â”‚
    â”Œâ”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”
    â”‚           â”‚
    â–¼           â–¼
  Admin      Regular User
    â”‚           â”‚
    â–¼           â–¼
 admin-    user-dashboard
 dashboard.php
    .php


3. PROTECTED REQUEST (With Token)
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
   â”‚ GET /api/orders      â”‚
   â”‚ Token: <JWT>         â”‚
   â”‚ (Header)             â”‚
   â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
          â”‚
          â–¼
   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
   â”‚ auth.middleware.js       â”‚
   â”‚ - Verify JWT token       â”‚
   â”‚ - Check expiry           â”‚
   â”‚ - Extract user info      â”‚
   â”‚ - Attach to request      â”‚
   â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
          â”‚
        Yesâ”‚ Valid?
        â”œâ”€â”€â”¤
   No   â”‚  â”‚
    â–¼   â–¼  â–¼
  401   Process
  Error Request
```

---

## ğŸ“± User Role-Based Access Flow

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚              ROLE-BASED ACCESS CONTROL                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

LOGIN SUCCESSFUL
â””â”€â”€ Check User Role
    â”‚
    â”œâ”€â”€ Role = "user"
    â”‚   â””â”€â–º user-dashboard.php
    â”‚       â”œâ”€ View own orders
    â”‚       â”œâ”€ View own profile
    â”‚       â”œâ”€ Update own info
    â”‚       â””â”€ Logout
    â”‚
    â”œâ”€â”€ Role = "admin"
    â”‚   â””â”€â–º admin-dashboard.php
    â”‚       â”œâ”€ View all users
    â”‚       â”œâ”€ View all orders
    â”‚       â”œâ”€ View statistics
    â”‚       â”œâ”€ Add/Edit/Delete products
    â”‚       â”œâ”€ Manage user roles
    â”‚       â””â”€ Logout
    â”‚
    â””â”€â”€ Invalid Role
        â””â”€â–º Error (redirect to login)


PROTECTED ENDPOINT ACCESS
â””â”€â”€ requireLogin()
    â”œâ”€â–º Not logged in? Redirect to login.php
    â””â”€â–º Logged in? Continue

â””â”€â”€ requireAdmin()
    â”œâ”€â–º Not logged in? Redirect to login.php
    â”œâ”€â–º Logged in but not admin? Redirect to user-dashboard.php
    â””â”€â–º Admin? Continue
```

---

## ğŸ“Š Database Relationships

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚            DATABASE SCHEMA DIAGRAM                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚      USERS         â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ _id (Primary)      â”‚
â”‚ name               â”‚
â”‚ email (Unique)     â”‚
â”‚ password (Hashed)  â”‚
â”‚ role               â”‚
â”‚ createdAt          â”‚
â”‚ updatedAt          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚ (1)
         â”‚
         â”‚ One User
         â”‚ Many Orders
         â”‚
         â”‚ (Many)
         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚      ORDERS        â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ _id (Primary)      â”‚
â”‚ userId (Foreign)â—„â”€â”€â”˜
â”‚ products[]         â”‚
â”‚ totalAmount        â”‚
â”‚ orderStatus        â”‚
â”‚ paymentStatus      â”‚
â”‚ shippingAddress    â”‚
â”‚ createdAt          â”‚
â”‚ updatedAt          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
         â”‚ (Array of Product IDs)
         â”‚
         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚     PRODUCTS       â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ _id (Primary)      â”‚
â”‚ title              â”‚
â”‚ price              â”‚
â”‚ stock              â”‚
â”‚ category           â”‚
â”‚ description        â”‚
â”‚ images[]           â”‚
â”‚ sizes[]            â”‚
â”‚ createdAt          â”‚
â”‚ updatedAt          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜


CATEGORY REFERENCE
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚    CATEGORIES      â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ men                â”‚
â”‚ women              â”‚
â”‚ kids               â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ” Authentication Token Flow

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚         JWT TOKEN LIFECYCLE                        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

1. GENERATION (on login/register)
   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
   â”‚ Backend creates JWT:           â”‚
   â”‚ {                              â”‚
   â”‚   userId: "...",               â”‚
   â”‚   email: "...",                â”‚
   â”‚   role: "user/admin",          â”‚
   â”‚   iat: (issued at),            â”‚
   â”‚   exp: (expires in 7 days)     â”‚
   â”‚ }                              â”‚
   â”‚ Signed with SECRET_KEY (HS256) â”‚
   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                â”‚
                â–¼
   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
   â”‚ Return to PHP:                 â”‚
   â”‚ {                              â”‚
   â”‚   "token": "eyJ...",           â”‚
   â”‚   "user": {...}                â”‚
   â”‚ }                              â”‚
   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                â”‚
                â–¼

2. STORAGE (in PHP session)
   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
   â”‚ storeAuthToken():              â”‚
   â”‚ $_SESSION['auth_token'] = "..." â”‚
   â”‚ $_SESSION['user_data'] = {...}  â”‚
   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                â”‚
                â–¼

3. USAGE (on every protected request)
   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
   â”‚ Include in Header:             â”‚
   â”‚ Authorization: Bearer <token>  â”‚
   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                â”‚
                â–¼
   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
   â”‚ Backend auth.middleware.js:    â”‚
   â”‚ - Extract token from header    â”‚
   â”‚ - Verify signature             â”‚
   â”‚ - Check expiry                 â”‚
   â”‚ - Attach user to request       â”‚
   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                â”‚
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚                â”‚
       YES              NO
        â”‚                â”‚
        â–¼                â–¼
    Process         Return 401
    Request         Unauthorized
                â”‚
                â–¼
        Redirect to login

4. EXPIRATION (after 7 days)
   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
   â”‚ Token automatically expires    â”‚
   â”‚ Backend rejects on next requestâ”‚
   â”‚ PHP session cleared            â”‚
   â”‚ User redirected to login       â”‚
   â”‚ Must login again               â”‚
   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ¯ Page Flow Diagram

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚           USER NAVIGATION FLOW                      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

NOT LOGGED IN
â•â•â•â•â•â•â•â•â•â•â•â•â•
   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
   â”‚ Start at homepage or  â”‚
   â”‚ access protected page â”‚
   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
              â”‚
              â–¼
   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
   â”‚ Check: isLoggedIn()? â”‚
   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
              â”‚
            NOâ”‚
              â–¼
   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
   â”‚ login.php            â”‚
   â”‚ (login form)         â”‚
   â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
          â”‚       â”‚
          â”‚       â””â”€â”€â–º "Don't have account?"
          â”‚            â”‚
          â”‚            â–¼
          â”‚       â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
          â”‚       â”‚ signup.php   â”‚
          â”‚       â”‚ (register)   â”‚
          â”‚       â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
          â”‚              â”‚
          â”‚    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
          â”‚    â”‚
          â””â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
               â”‚                â”‚
        Login  â”‚  Register      â”‚
        Submit â”‚  Submit        â”‚
               â–¼                â–¼
        POST /api/v1/auth/login    POST /api/v1/auth/register
               â”‚                â”‚
        â”Œâ”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
        â”‚
        â–¼
   Generated JWT Token
   Stored in Session
        â”‚
        â–¼
   Check Role
        â”‚
   â”Œâ”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”
   â”‚          â”‚
  USER      ADMIN
   â”‚          â”‚
   â–¼          â–¼


LOGGED IN - REGULAR USER
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
   â”‚ user-dashboard.php   â”‚
   â”‚ (user homepage)      â”‚
   â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
   â”‚ - View orders        â”‚
   â”‚ - View profile       â”‚
   â”‚ - Update info        â”‚
   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
              â”‚
        â”Œâ”€â”€â”€â”€â”€â”˜
        â”‚
        â”œâ”€â”€â–º "Browse Products" â”€â”€â–º product pages (index.php)
        â”‚
        â”œâ”€â”€â–º "My Orders" â”€â”€â”€â”€â”€â”€â”€â”€â–º orders list
        â”‚
        â”œâ”€â”€â–º "Settings" â”€â”€â”€â”€â”€â”€â”€â”€â”€â–º edit profile
        â”‚
        â””â”€â”€â–º "Logout" â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–º logout-connected.php
                                  â”‚
                                  â–¼
                           Clear Session
                                  â”‚
                                  â–¼
                           login.php


LOGGED IN - ADMIN
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
   â”‚ admin-dashboard.php  â”‚
   â”‚ (admin homepage)     â”‚
   â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
   â”‚ - View stats         â”‚
   â”‚ - Manage products    â”‚
   â”‚ - Manage orders      â”‚
   â”‚ - Manage users       â”‚
   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
              â”‚
        â”Œâ”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚                  â”‚
        â”œâ”€â”€â–º Products     â”œâ”€â”€â–º Add product
        â”‚    Section       â”œâ”€â”€â–º Edit product
        â”‚                  â””â”€â”€â–º Delete product
        â”‚
        â”œâ”€â”€â–º Orders â”€â”€â”€â”€â”€â”€â”¬â”€â”€â–º View order
        â”‚    Section      â”œâ”€â”€â–º Update status
        â”‚                 â””â”€â”€â–º View customer
        â”‚
        â”œâ”€â”€â–º Users â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â–º View user
        â”‚    Section      â”œâ”€â”€â–º Change role
        â”‚                 â””â”€â”€â–º Delete user
        â”‚
        â”œâ”€â”€â–º Stats â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â–º Total revenue
        â”‚    Dashboard    â”œâ”€â”€â–º Total orders
        â”‚                 â”œâ”€â”€â–º Total users
        â”‚                 â””â”€â”€â–º Total products
        â”‚
        â””â”€â”€â–º "Logout" â”€â”€â”€â”€â”€â”€â–º logout-connected.php
                              â”‚
                              â–¼
                       Clear Session
                              â”‚
                              â–¼
                       login.php
```

---

## ğŸŒ Request Response Cycle

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚         REQUEST/RESPONSE CYCLE                      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

USER ACTION (Frontend)
   â”‚
   â””â”€â”€â–º Click Button / Submit Form
        â”‚
        â–¼
PHP Page Processes
   â”‚
   â””â”€â”€â–º Get form data / Button click
        â”‚
        â”œâ”€â”€â–º Check session: isLoggedIn()?
        â”‚    â”œâ”€â”€ NO â†’ Redirect to login
        â”‚    â””â”€â”€ YES â†’ Continue
        â”‚
        â””â”€â”€â–º Prepare API request
             â”‚
             â–¼
cURL Request (api-helper.php)
   â”‚
   â”œâ”€â”€â–º Build URL: localhost:5000/api/endpoint
   â”œâ”€â”€â–º Set HTTP method (GET/POST/PUT/DELETE)
   â”œâ”€â”€â–º Add headers:
   â”‚    â”œâ”€â”€ Content-Type: application/json
   â”‚    â””â”€â”€ Authorization: Bearer <token>
   â”œâ”€â”€â–º Add data (if POST/PUT)
   â””â”€â”€â–º Execute cURL request
        â”‚
        â–¼
Transmitted over Network
   â”‚
   â–¼
Express Backend (server.js)
   â”‚
   â”œâ”€â”€â–º Receive HTTP Request
   â”‚    â”‚
   â”‚    â”œâ”€â”€â–º Parse headers & body
   â”‚    â”œâ”€â”€â–º Log request (morgan)
   â”‚    â””â”€â”€â–º Route to handler
   â”‚
   â”œâ”€â”€â–º Middleware Processing
   â”‚    â”‚
   â”‚    â”œâ”€â”€â–º CORS check
   â”‚    â”œâ”€â”€â–º Auth check (if protected)
   â”‚    â”‚    â”œâ”€â”€ Extract token from header
   â”‚    â”‚    â”œâ”€â”€ Verify JWT signature
   â”‚    â”‚    â”œâ”€â”€ Check expiry
   â”‚    â”‚    â””â”€â”€ Attach user to request
   â”‚    â”‚
   â”‚    â””â”€â”€â–º Input validation
   â”‚
   â”œâ”€â”€â–º Controller Action
   â”‚    â”‚
   â”‚    â”œâ”€â”€â–º Business logic
   â”‚    â”œâ”€â”€â–º Database query (MongoDB)
   â”‚    â”‚    â”œâ”€â”€ Read data
   â”‚    â”‚    â”œâ”€â”€ Create/Update/Delete
   â”‚    â”‚    â””â”€â”€ Handle errors
   â”‚    â”‚
   â”‚    â””â”€â”€â–º Format response
   â”‚
   â””â”€â”€â–º Send Response
        â”‚
        â”œâ”€â”€â–º HTTP status code (200/400/401/500)
        â”œâ”€â”€â–º JSON body
        â”‚    â”œâ”€â”€ "success": true/false
        â”‚    â”œâ”€â”€ "message": "..."
        â”‚    â””â”€â”€ "data": {...}
        â”‚
        â–¼
Transmitted back over Network
   â”‚
   â–¼
PHP Receives Response (api-helper.php)
   â”‚
   â”œâ”€â”€â–º Parse JSON
   â”œâ”€â”€â–º Check HTTP status
   â”œâ”€â”€â–º Check 'success' field
   â””â”€â”€â–º Return array to PHP page
        â”‚
        â–¼
PHP Page Processes Response
   â”‚
   â”œâ”€â”€â–º if ($response['success'])
   â”‚    â”œâ”€â”€â–º Process data
   â”‚    â”œâ”€â”€â–º Update session if needed
   â”‚    â”œâ”€â”€â–º Set success message
   â”‚    â””â”€â”€â–º Redirect or reload page
   â”‚
   â””â”€â”€â–º else
        â”œâ”€â”€â–º Display error message
        â””â”€â”€â–º Stay on page
             â”‚
             â–¼
User Sees Result
   â”‚
   â”œâ”€â”€â–º Success message & data
   â”œâ”€â”€â–º Error message
   â””â”€â”€â–º Redirect to new page
```

---

## ğŸ”§ Technology Stack Diagram

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚           TECHNOLOGY STACK                          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

FRONTEND LAYER
â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    HTML5
      â”‚
    CSS3 (styling)
      â”‚
    PHP 7.4+ (server-side)
      â”‚
    cURL (HTTP client)
      â”‚
    Sessions (state management)

       â–¼
    XAMPP/Apache
    Port: 80


API COMMUNICATION LAYER
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    HTTP/HTTPS
    JSON (data format)
    cURL (transport)
    JWT (authentication)


BACKEND LAYER
â•â•â•â•â•â•â•â•â•â•â•â•â•
    Node.js Runtime
      â”‚
    Express.js (web framework)
      â”‚
    Middleware:
      â”œâ”€ CORS
      â”œâ”€ Body Parser
      â”œâ”€ Error Handler
      â”œâ”€ Auth Validator
      â””â”€ Rate Limiter
      â”‚
    Controllers (business logic)
      â”‚
    Services (helpers)
      â”‚
    Mongoose ODM (database access)

       â–¼
    Server on Port 5000


DATABASE LAYER
â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    MongoDB Atlas (Cloud)
      â”‚
    Collections:
      â”œâ”€ users
      â”œâ”€ products
      â”œâ”€ orders
      â””â”€ categories
      â”‚
    Indexes (for performance)
      â”‚
    Replication (high availability)
    Backup (automatic)


SECURITY LAYER
â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    Passwords: bcryptjs
    Sessions: PHP $_SESSION
    Tokens: JWT (HS256)
    Validation: Schema + Controllers
    CORS: Configured
    Rate Limiting: Express middleware
```

---

## ğŸ“ˆ Deployment Architecture (Optional)

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚        PRODUCTION DEPLOYMENT LAYOUT                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

CURRENT (Development)
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    Your Computer
    â”œâ”€â”€â”€ XAMPP/Apache (Frontend)
    â”‚    â””â”€ PHP files
    â”‚
    â””â”€â”€â”€ Node.js (Backend)
         â””â”€ Express server
              â”‚
              â””â”€â–º MongoDB Atlas (Cloud)


FUTURE (Production)
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    Domain: urbanwear.com

    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚   Frontend       â”‚
    â”‚ (VPS/Hosting)    â”‚
    â”‚   XAMPP/Apache   â”‚
    â”‚   PHP 7.4+       â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
             â”‚ HTTPS
             â”‚
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚   Backend API     â”‚
    â”‚ (Cloud Server)    â”‚
    â”‚ Node.js/Express   â”‚
    â”‚ Railway/Heroku    â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
             â”‚
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚   MongoDB Atlas   â”‚
    â”‚   (Cloud DB)      â”‚
    â”‚ Replicated        â”‚
    â”‚ Backed up         â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

    CDN (for images)
    â”œâ”€ Cloudinary
    â”œâ”€ S3
    â””â”€ or similar

    Email Service
    â”œâ”€ SendGrid
    â”œâ”€ Mailgun
    â””â”€ or similar

    Payment Gateway
    â”œâ”€ Stripe
    â”œâ”€ PayPal
    â””â”€ or similar
```

---

**End of Architecture Diagrams**
